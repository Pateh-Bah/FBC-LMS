{% extends 'admin/admin_base.html' %}
{% load static %}

{% block title %}Student Dashboard - FBC Library{% endblock %}
{% block page_title %}Student Dashboard{% endblock %}

{% block content %}
<!-- Classical Library Header for Students -->
<div class="relative bg-gradient-to-r from-library-navy via-library-burgundy to-library-navy rounded-none shadow-2xl mb-12">
    <div class="absolute inset-0 bg-black opacity-10"></div>
    <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1000 100\" fill=\"none\"><path d=\"M0,50 Q250,20 500,50 T1000,50 L1000,100 L0,100 Z\" fill=\"%23ffffff\" fill-opacity=\"0.03\"/></svg>');"></div>
    
    <div class="relative z-10 px-8 py-16">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-6">
                    <!-- Classical Student Icon -->
                    <div class="w-20 h-20 bg-library-gold rounded-full flex items-center justify-center shadow-lg animate-glow">
                        <i class="fas fa-user-graduate text-2xl text-library-navy"></i>
                    </div>
                    <div>
                        <h1 class="font-serif text-5xl font-bold text-white mb-2 tracking-wide">
                            Student 
                            <span class="text-library-gold">Portal</span>
                        </h1>
                        <p class="text-library-cream text-xl font-body italic">
                            "The roots of education are bitter, but the fruit is sweet" - Welcome, {{ user.get_full_name|default:user.username }}
                        </p>
                        <div class="flex items-center space-x-6 mt-4">
                            <div class="flex items-center space-x-2 bg-white bg-opacity-10 rounded-lg px-4 py-2 backdrop-blur-sm">
                                <i class="fas fa-graduation-cap text-library-gold"></i>
                                <span class="text-library-cream font-semibold">Student Scholar</span>
                            </div>
                            {% if user.subscription_end_date %}
                            <div class="flex items-center space-x-2 bg-white bg-opacity-10 rounded-lg px-4 py-2 backdrop-blur-sm">
                                <i class="fas fa-{% if user.is_subscription_active %}check-circle{% else %}exclamation-triangle{% endif %} text-{% if user.is_subscription_active %}green{% else %}red{% endif %}-400"></i>
                                <span class="text-library-cream font-semibold">
                                    {% if user.is_subscription_active %}
                                        Active Subscription
                                    {% else %}
                                        Subscription Expired
                                    {% endif %}
                                </span>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- Classical Decorative Element -->
                <div class="hidden xl:block">
                    <div class="w-40 h-40 relative">
                        <div class="absolute inset-0 border-4 border-library-gold rounded-full animate-float opacity-30"></div>
                        <div class="absolute inset-4 border-2 border-library-cream rounded-full animate-float opacity-50" style="animation-delay: 1s;"></div>
                        <div class="absolute inset-8 bg-library-gold rounded-full flex items-center justify-center shadow-xl">
                            <i class="fas fa-book text-3xl text-library-navy"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

    <!-- Student Learning Statistics -->
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8 mb-12">
        <!-- Current Borrowings Card -->
        <div class="group relative bg-white rounded-2xl shadow-xl border-l-4 border-library-navy overflow-hidden hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2">
            <div class="absolute top-0 right-0 w-20 h-20 bg-library-navy opacity-5 rounded-bl-full"></div>
            <div class="relative p-8">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="w-12 h-12 bg-library-navy bg-opacity-10 rounded-xl flex items-center justify-center mb-4 group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-book-reader text-xl text-library-navy"></i>
                        </div>
                        <h3 class="font-serif text-3xl font-bold text-library-navy mb-2">{{ user_borrowings_count|default:0 }}</h3>
                        <p class="text-gray-600 font-body">Current Borrowings</p>
                        <div class="mt-3 flex items-center text-green-600 text-sm font-semibold">
                            <i class="fas fa-clock mr-1"></i>
                            <span>Due Soon: {{ due_soon|default:0 }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Books Read Card -->
        <div class="group relative bg-white rounded-2xl shadow-xl border-l-4 border-library-burgundy overflow-hidden hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2">
            <div class="absolute top-0 right-0 w-20 h-20 bg-library-burgundy opacity-5 rounded-bl-full"></div>
            <div class="relative p-8">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="w-12 h-12 bg-library-burgundy bg-opacity-10 rounded-xl flex items-center justify-center mb-4 group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-book-open text-xl text-library-burgundy"></i>
                        </div>
                        <h3 class="font-serif text-3xl font-bold text-library-burgundy mb-2">{{ books_read|default:0 }}</h3>
                        <p class="text-gray-600 font-body">Books Completed</p>
                        <div class="mt-3 flex items-center text-blue-600 text-sm font-semibold">
                            <i class="fas fa-trophy mr-1"></i>
                            <span>This Semester</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Subscription Status Card -->
        <div class="group relative bg-white rounded-2xl shadow-xl border-l-4 border-library-gold overflow-hidden hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2">
            <div class="absolute top-0 right-0 w-20 h-20 bg-library-gold opacity-5 rounded-bl-full"></div>
            <div class="relative p-8">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="w-12 h-12 bg-library-gold bg-opacity-10 rounded-xl flex items-center justify-center mb-4 group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-crown text-xl text-yellow-700"></i>
                        </div>
                        <h3 class="font-serif text-lg font-bold text-yellow-700 mb-2">
                            {% if user.is_subscription_active %}Premium{% else %}Basic{% endif %}
                        </h3>
                        <p class="text-gray-600 font-body">Access Level</p>
                        <div class="mt-3 flex items-center {% if user.is_subscription_active %}text-green-600{% else %}text-orange-600{% endif %} text-sm font-semibold">
                            <i class="fas fa-{% if user.is_subscription_active %}check-circle{% else %}exclamation-circle{% endif %} mr-1"></i>
                            <span>{% if user.is_subscription_active %}Active{% else %}Upgrade{% endif %}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Library Credits Card -->
        <div class="group relative bg-white rounded-2xl shadow-xl border-l-4 border-library-sage overflow-hidden hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2">
            <div class="absolute top-0 right-0 w-20 h-20 bg-library-sage opacity-5 rounded-bl-full"></div>
            <div class="relative p-8">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="w-12 h-12 bg-library-sage bg-opacity-10 rounded-xl flex items-center justify-center mb-4 group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-coins text-xl text-library-sage"></i>
                        </div>
                        <h3 class="font-serif text-3xl font-bold text-library-sage mb-2">${{ outstanding_fines|default:0 }}</h3>
                        <p class="text-gray-600 font-body">Outstanding Fines</p>
                        <div class="mt-3 flex items-center {% if outstanding_fines %}text-red-600{% else %}text-green-600{% endif %} text-sm font-semibold">
                            <i class="fas fa-{% if outstanding_fines %}exclamation-triangle{% else %}check-circle{% endif %} mr-1"></i>
                            <span>{% if outstanding_fines %}Pay Now{% else %}All Clear{% endif %}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 xl:grid-cols-3 gap-8 mb-12">
        <!-- Student Quick Actions -->
        <div class="xl:col-span-2 bg-white rounded-2xl shadow-xl overflow-hidden">
            <!-- Classical Header -->
            <div class="bg-gradient-to-r from-library-parchment to-library-cream border-b border-warm-gray-200 p-8">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="w-14 h-14 bg-library-navy rounded-xl flex items-center justify-center shadow-lg">
                            <i class="fas fa-graduation-cap text-white text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-serif text-2xl font-bold text-library-navy">Student Learning Hub</h3>
                            <p class="text-warm-gray-600 font-body italic">Your gateway to knowledge and discovery</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Cards Grid -->
            <div class="p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <a href="{% url 'fbc_books:book_list' %}" class="group flex items-center p-6 bg-library-parchment rounded-xl hover:bg-library-cream transition-all duration-300 border border-warm-gray-100 hover:border-library-gold">
                        <div class="w-12 h-12 bg-library-burgundy bg-opacity-10 rounded-lg flex items-center justify-center group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-search text-library-burgundy text-xl"></i>
                        </div>
                        <div class="ml-4 flex-1">
                            <h4 class="font-serif font-semibold text-library-navy text-lg group-hover:text-library-burgundy transition-colors">Browse Library</h4>
                            <p class="text-warm-gray-600 font-body text-sm">Discover books and resources</p>
                        </div>
                        <i class="fas fa-chevron-right text-warm-gray-400 group-hover:text-library-gold transition-colors"></i>
                    </a>

                    <a href="{% url 'fbc_books:book_list' %}" class="group flex items-center p-6 bg-library-parchment rounded-xl hover:bg-library-cream transition-all duration-300 border border-warm-gray-100 hover:border-library-gold">
                        <div class="w-12 h-12 bg-library-sage bg-opacity-10 rounded-lg flex items-center justify-center group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-book-reader text-library-sage text-xl"></i>
                        </div>
                        <div class="ml-4 flex-1">
                            <h4 class="font-serif font-semibold text-library-navy text-lg group-hover:text-library-sage transition-colors">My Borrowings</h4>
                            <p class="text-warm-gray-600 font-body text-sm">View current and past loans</p>
                        </div>
                        <i class="fas fa-chevron-right text-warm-gray-400 group-hover:text-library-gold transition-colors"></i>
                    </a>

                    <a href="{% url 'users:profile' %}" class="group flex items-center p-6 bg-library-parchment rounded-xl hover:bg-library-cream transition-all duration-300 border border-warm-gray-100 hover:border-library-gold">
                        <div class="w-12 h-12 bg-library-navy bg-opacity-10 rounded-lg flex items-center justify-center group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-user-cog text-library-navy text-xl"></i>
                        </div>
                        <div class="ml-4 flex-1">
                            <h4 class="font-serif font-semibold text-library-navy text-lg group-hover:text-library-navy transition-colors">My Profile</h4>
                            <p class="text-warm-gray-600 font-body text-sm">Update personal information</p>
                        </div>
                        <i class="fas fa-chevron-right text-warm-gray-400 group-hover:text-library-gold transition-colors"></i>
                    </a>

                    {% if not user.is_subscription_active %}
                    <a href="#" class="group flex items-center p-6 bg-library-parchment rounded-xl hover:bg-library-cream transition-all duration-300 border border-warm-gray-100 hover:border-library-gold">
                        <div class="w-12 h-12 bg-yellow-600 bg-opacity-10 rounded-lg flex items-center justify-center group-hover:bg-opacity-20 transition-colors">
                            <i class="fas fa-credit-card text-yellow-700 text-xl"></i>
                        </div>
                        <div class="ml-4 flex-1">
                            <h4 class="font-serif font-semibold text-library-navy text-lg group-hover:text-yellow-700 transition-colors">Upgrade Subscription</h4>
                            <p class="text-warm-gray-600 font-body text-sm">Access premium resources</p>
                        </div>
                        <i class="fas fa-chevron-right text-warm-gray-400 group-hover:text-library-gold transition-colors"></i>
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Academic Resources & Study Tools -->
        <div class="space-y-8">
            <!-- Academic Resources -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="bg-gradient-to-r from-library-navy to-library-burgundy p-6">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-library-gold rounded-lg flex items-center justify-center shadow-md">
                            <i class="fas fa-book text-library-navy text-sm"></i>
                        </div>
                        <div>
                            <h3 class="font-serif text-lg font-bold text-white">Academic Resources</h3>
                            <p class="text-library-cream text-sm font-body italic">Essential study materials</p>
                        </div>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <div class="flex items-center p-4 rounded-xl hover:bg-library-parchment transition-all duration-300 border border-transparent hover:border-library-gold">
                        <div class="w-10 h-10 bg-library-burgundy bg-opacity-10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-graduation-cap text-library-burgundy text-sm"></i>
                        </div>
                        <div class="ml-4">
                            <span class="font-body font-semibold text-library-navy">Course Textbooks</span>
                            <p class="text-warm-gray-600 text-sm">Required and recommended readings</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-4 rounded-xl hover:bg-library-parchment transition-all duration-300 border border-transparent hover:border-library-gold">
                        <div class="w-10 h-10 bg-library-sage bg-opacity-10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-journal-whills text-library-sage text-sm"></i>
                        </div>
                        <div class="ml-4">
                            <span class="font-body font-semibold text-library-navy">Research Journals</span>
                            <p class="text-warm-gray-600 text-sm">Academic papers and articles</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-4 rounded-xl hover:bg-library-parchment transition-all duration-300 border border-transparent hover:border-library-gold">
                        <div class="w-10 h-10 bg-library-navy bg-opacity-10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-laptop text-library-navy text-sm"></i>
                        </div>
                        <div class="ml-4">
                            <span class="font-body font-semibold text-library-navy">Digital Resources</span>
                            <p class="text-warm-gray-600 text-sm">E-books and online materials</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Study Tools -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="bg-gradient-to-r from-library-sage to-library-navy p-6">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-library-gold rounded-lg flex items-center justify-center shadow-md">
                            <i class="fas fa-tools text-library-navy text-sm"></i>
                        </div>
                        <div>
                            <h3 class="font-serif text-lg font-bold text-white">Study Tools</h3>
                            <p class="text-library-cream text-sm font-body italic">Academic support utilities</p>
                        </div>
                    </div>
                </div>
                <div class="p-6 space-y-6">
                    <div class="flex items-center justify-between p-4 bg-library-parchment rounded-xl">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-quote-left text-blue-600 text-sm"></i>
                            </div>
                            <span class="font-body font-semibold text-library-navy">Citation Tools</span>
                        </div>
                        <span class="text-library-burgundy font-bold font-serif">Available</span>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-library-parchment rounded-xl">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-file-alt text-green-600 text-sm"></i>
                            </div>
                            <span class="font-body font-semibold text-library-navy">Study Guides</span>
                        </div>
                        <span class="text-library-sage font-bold font-serif">Access</span>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-library-parchment rounded-xl">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                                <i class="fas fa-question-circle text-purple-600 text-sm"></i>
                            </div>
                            <span class="font-body font-semibold text-library-navy">Help & Tutorials</span>
                        </div>
                        <span class="text-library-navy font-bold font-serif">Learn</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Subscription Status Information -->
    {% if user.subscription_end_date %}
    <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
        <div class="bg-gradient-to-r from-{% if user.is_subscription_active %}library-sage{% else %}red-600{% endif %} to-{% if user.is_subscription_active %}library-navy{% else %}red-800{% endif %} p-6">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-library-gold rounded-lg flex items-center justify-center shadow-md">
                    <i class="fas fa-{% if user.is_subscription_active %}check-circle{% else %}exclamation-triangle{% endif %} text-library-navy text-sm"></i>
                </div>
                <div>
                    <h3 class="font-serif text-lg font-bold text-white">
                        {% if user.is_subscription_active %}Premium Subscription Active{% else %}Subscription Expired{% endif %}
                    </h3>
                    <p class="text-library-cream text-sm font-body italic">
                        {% if user.is_subscription_active %}
                            Valid until {{ user.subscription_end_date|date:"F d, Y" }}
                        {% else %}
                            Expired on {{ user.subscription_end_date|date:"F d, Y" }}
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
        <div class="p-6 {% if user.is_subscription_active %}bg-green-50{% else %}bg-red-50{% endif %}">
            <div class="flex items-start space-x-4">
                <div class="w-8 h-8 {% if user.is_subscription_active %}bg-green-100{% else %}bg-red-100{% endif %} rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                    <i class="fas fa-{% if user.is_subscription_active %}star{% else %}clock{% endif %} {% if user.is_subscription_active %}text-green-600{% else %}text-red-600{% endif %} text-sm"></i>
                </div>
                <div class="flex-1">
                    <p class="{% if user.is_subscription_active %}text-green-700{% else %}text-red-700{% endif %} font-body mb-4">
                        {% if user.is_subscription_active %}
                            You have full access to all library resources including premium e-books, extended borrowing periods, 
                            and exclusive academic databases. Your subscription includes unlimited downloads and priority support.
                        {% else %}
                            Your subscription has expired. Please renew to continue accessing premium features including 
                            e-books, extended borrowing periods, and academic databases.
                        {% endif %}
                    </p>
                    {% if not user.is_subscription_active %}
                    <a href="#" class="inline-flex items-center px-6 py-3 bg-red-600 text-white font-serif font-semibold rounded-xl hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-300 shadow-lg hover:shadow-xl">
                        <i class="fas fa-credit-card mr-3"></i>
                        Renew Premium Subscription
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}

<style>
/* Additional Classical Styling for Students */
.custom-scrollbar::-webkit-scrollbar {
    width: 8px;
}

.custom-scrollbar::-webkit-scrollbar-track {
    background: #f7f3e9;
    border-radius: 4px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
    background: #8b4513;
    border-radius: 4px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #654321;
}

.animate-glow {
    animation: glow 2s ease-in-out infinite alternate;
}

@keyframes glow {
    from {
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
    }
    to {
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
    }
}

.animate-float {
    animation: float 6s ease-in-out infinite;
}

@keyframes float {
    0%, 100% {
        transform: translateY(0px);
    }
    50% {
        transform: translateY(-20px);
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
// Enhanced student dashboard interactions
document.addEventListener('DOMContentLoaded', function() {
    // Animated counters with classical easing
    const counters = document.querySelectorAll('.font-serif.text-3xl.font-bold');
    counters.forEach(counter => {
        const target = parseInt(counter.textContent);
        if (!isNaN(target)) {
            let current = 0;
            const increment = target / 50;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    counter.textContent = target;
                    clearInterval(timer);
                } else {
                    counter.textContent = Math.ceil(current);
                }
            }, 80);
        }
    });
    
    // Add elegant hover effects to cards
    const cards = document.querySelectorAll('.group');
    cards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-8px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
});
</script>
{% endblock %}

